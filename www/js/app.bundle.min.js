!function(){"use strict";angular.module("about.controllers",[]).controller("AboutCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(e,t,i,o,n){}])}(),function(){"use strict";angular.module("category-add.controllers",[]).controller("categoryAddCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicActionSheet","$stateParams",function(e,t,i,o,n,a){e.$on("$ionicView.beforeEnter",function(){e.addCategory="0"==a.id,e.category=i.getCategoryById(a.id)||{name:""},e.sections=[{name:""}]}),e.addSection=function(){e.sections.filter(function(e){return!e.name}).length||e.sections.push({name:""})},e.removeSection=function(t){e.sections.splice(t,1)},e.saveCategory=function(){var o=e.sections.filter(function(e){return!e.name});if(!e.category.id&&e.category.name||e.category.id&&!o.length)if(e.category.id)i.createSubCategory(e.category.id,angular.copy(e.sections)),t.go("app.category",{activeId:e.category.id},{location:"replace"});else{e.category.children=e.sections;var n=i.addCategory(angular.copy(e.category));t.go("app.category",{activeId:n},{location:"replace"})}}}])}(),function(){"use strict";angular.module("category-edit.controllers",[]).controller("categoryEditCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicPopup","$stateParams",function(e,t,i,o,n,a){e.category=i.getCategoryById(a.id),e.sections=e.category.children||[],e.addSection=function(){e.sections.filter(function(e){return!e.name}).length||e.sections.push({name:""})},e.removeCategory=function(){n.confirm({title:"您确认要删除吗？",template:"请先删除该类别下的所有商品记录",cancelText:"取消",okText:"确认"}).then(function(o){i.deleteCategory(e.category.id),t.go("app.category",{activeId:e.category.id},{location:"replace"})})},e.removeSection=function(t){n.confirm({title:"您确认要删除吗？",template:"请先删除该类别下的所有商品记录",cancelText:"取消",okText:"确认"}).then(function(i){e.sections.splice(t,1)})},e.saveCategory=function(){var o=e.sections.filter(function(e){return!e.name});e.category.name&&!o.length&&(e.category.children=e.sections,i.updateCategory(e.category.id,e.category),t.go("app.category",{activeId:e.category.id},{location:"replace"}))}}])}(),function(){"use strict";angular.module("category.controllers",["category-add.controllers","category-edit.controllers"]).controller("categoryCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicActionSheet","$stateParams",function(e,t,i,o,n,a){var r=a.activeId||0;e.$on("$stateChangeSuccess",function(t,o,n,a,c){if("app.home"===a.name&&(e.showInfo="无小分类进入大分类"),"app.product"===a.name&&(e.showInfo="全部商品"),"app.category"!==a.name)if(e.categories=i.getAll(!0),r){var s=!1;e.categories.forEach(function(t){t.id==r&&(e.activeCategory=t,e.sections=t.children,s=!0,e.sections&&0!=e.sections[0].id&&e.sections.unshift({id:0,name:e.showInfo||"无小分类进入大分类"}))}),s||(e.activeCategory=e.categories[0],e.sections=e.categories[0].children,e.sections&&0!=e.sections[0].id&&e.sections.unshift({id:0,name:e.showInfo||"无小分类进入大分类"}))}else e.activeCategory=e.categories[0],e.sections=e.categories[0].children,e.sections&&0!=e.sections[0].id&&e.sections.unshift({id:0,name:e.showInfo||"无小分类进入大分类"})}),e.selectCategory=function(t){e.activeCategory.id!=t&&angular.forEach(e.categories,function(i,o){i.id==t&&(e.activeCategory=i,e.sections=i.children,e.sections&&0!=e.sections[0].id&&e.sections.unshift({id:0,name:e.showInfo||"无小分类进入大分类"}))})},e.selectSection=function(t){e.activeSection={id:e.activeCategory.id,name:e.activeCategory.name,section:{id:t.id,name:t.id?t.name:""}},o.goBack()},e.$watch("activeSection",function(e,t){e&&i.updateActiveCategory(e)}),e.showActionSheet=function(){n.show({buttons:[{text:"新增小分类"},{text:"编辑分类"}],cancelText:"<b>取消</b>",buttonClicked:function(i){switch(i){case 0:t.go("app.categoryAdd",{id:e.activeCategory.id});break;case 1:t.go("app.categoryEdit",{id:e.activeCategory.id})}}})}}])}(),function(){"use strict";angular.module("category.service",[]).factory("CategoryService",["$rootScope","LocalStorageService",function(e,t){var i={},o="CATEGORY",n=[{id:1,name:"电脑整机",parent_id:0},{id:2,name:"电脑配件",parent_id:0},{id:3,name:"外设产品",parent_id:0},{id:4,name:"网络产品",parent_id:0},{id:5,name:"笔记本",parent_id:1},{id:6,name:"台式机",parent_id:1},{id:7,name:"平板电脑",parent_id:1},{id:8,name:"CPU",parent_id:2},{id:9,name:"内存",parent_id:2},{id:10,name:"鼠标",parent_id:3},{id:11,name:"键盘",parent_id:3},{id:12,name:"U盘",parent_id:3},{id:13,name:"路由器",parent_id:4},{id:14,name:"交换机",parent_id:4},{id:15,name:"网卡",parent_id:4},{id:16,name:"网络配件",parent_id:4}];return i.activeCategory={},i.updateActiveCategory=function(t){this.activeCategory=angular.copy(t),e.$broadcast("ActiveCategoryUpdate")},i.init=function(){this.originData=t.get(o),this.originData||(t.update(o,n),this.originData=n),this.refresh()},i.refresh=function(){this.dataMap={},this.originData.forEach(function(e){if(!e.parent_id){var t=angular.copy(e);t.children=[],this.dataMap[t.id]=t}}.bind(this)),this.originData.forEach(function(e){if(e.parent_id){var t=angular.copy(e);this.dataMap[e.parent_id].children.push(t)}}.bind(this)),this.nowId=this.originData.length?Math.max.apply(null,this.originData.map(function(e){return e.id})):0},i.getAll=function(e){return e?Object.keys(this.dataMap).map(function(e){return angular.copy(this.dataMap[e])}.bind(this)):this.originData},i.getCategoryById=function(e){return angular.copy(this.dataMap[e])},i.getSubCategoryByCategoryId=function(e){return this.dataMap[id]&&angular.copy(this.dataMap[id].children)},i.addCategory=function(e){var t=e.children||[];delete e.children;var i=this.createCategory(e);return t.length&&this.createSubCategory(i,t),i},i.createCategory=function(e){return e.id=this.nowId+1,e.parent_id=0,this.originData.push(e),t.update(o,this.originData),this.refresh(),e.id},i.createSubCategory=function(e,i){return i=i.map(function(t,i){return t.id=this.nowId+i+1,t.parent_id=e,t}.bind(this)),this.originData=this.originData.concat(i),t.update(o,this.originData),this.refresh(),!0},i.deleteCategory=function(e){return this.originData=this.originData.filter(function(t){return t.parent_id!=e&&t.id!=e}),t.update(o,this.originData),this.refresh(),!0},i.deleteSubCategoryByCategoryId=function(e){return this.originData=this.originData.filter(function(t){return t.parent_id!=e}),t.update(o,this.originData),this.refresh(),!0},i.updateCategory=function(e,t){return this.originData.forEach(function(i){i.id==e&&(i.name=t.name)}),t.children.length&&this.updateSubCategory(e,t.children),this.refresh(),this.getCategoryById(e)},i.updateSubCategory=function(e,t){return this.deleteSubCategoryByCategoryId(e),this.createSubCategory(e,t),!0},i.init(),i}])}(),function(){"use strict";angular.module("home.controllers",[]).controller("HomeCtrl",["$scope","$state","UserService",function(e,t,i){e.$on("$ionicView.beforeEnter",function(e,o){i.getIsLogin()||t.go("login")})}])}(),function(){"use strict"}(),function(){"use strict"}(),function(){"use strict";angular.module("login.controllers",[]).controller("LoginCtrl",["$scope","$state","$ionicPopup","UserService",function(e,t,i,o){var n=o.getUserData();e.loginData=o.getRememberUser(),e.login=function(){e.loginData.username==n.username&&e.loginData.password==n.password?(o.updateRememberUser(e.loginData),o.updateIsLogin(!0),t.go("app.home",{},{location:"replace"})):i.alert({title:"警告",template:"您的用户名或者密码错误",okText:"确定",okType:"button-energized"})}}])}(),function(){"use strict";angular.module("menu.controllers",[]).controller("AppCtrl",["$scope","$ionicModal","$timeout",function(e,t,i){e.loginData={},e.shopData={name:"黄加樑",phone:"18305961659"}}])}(),function(){"use strict";angular.module("prodcut-add.controllers",[]).controller("ProductAddCtrl",["$scope","$state","$ionicPopup","$ionicActionSheet","ProductService","CategoryService","$ionicHistory","$stateParams","$cordovaBarcodeScanner","$cordovaCamera","$cordovaImagePicker",function(e,t,i,o,n,a,r,c,s,u,d){function l(){var t={quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,targetWidth:100,targetHeight:100,correctOrientation:!0,saveToPhotoAlbum:!1,popoverOptions:CameraPopoverOptions};u.getPicture(t).then(function(t){e.product.images.push(t)},function(e){alert(e)})}function p(){var t={maximumImagesCount:3,width:0,height:0,quality:80};d.getPictures(t).then(function(t){for(var i=0;i<t.length;i++)e.product.images.push(t[i])},function(e){alert(e)})}function g(t){i.confirm({title:"您确认要新增商品吗？",cancelText:"取消",okText:"确认"}).then(function(){n.createProduct(e.product),t()})}var h={images:[],barcode:"",category:{id:0,name:"默认分类",section:{id:0,name:""}},name:"",price:"",cost:"",stock:"",size:"",remark:"",supplier:{name:"",phone:""}},f={name:"",phone:""};e.product=angular.copy(h),e.supplier=angular.copy(f),e.$on("ActiveCategoryUpdate",function(){e.product.category=a.activeCategory}),e.scanBarcode=function(){s.scan().then(function(t){e.product.barcode=t.text,alert(t.text)},function(e){alert(e)})},e.showActionSheet=function(){o.show({buttons:[{text:"拍照"},{text:"从相册中选取"}],cancelText:"<b>取消</b>",buttonClicked:function(e){switch(e){case 0:l();break;case 1:p()}}})},e.selectSupplier=function(){i.show({title:"新增供应商",templateUrl:"views/supplier/supplier.html",scope:e,buttons:[{text:"取消",type:"button-energized button-outline",onTap:function(t){e.supplier=angular.copy(f)}},{text:"确定",type:"button-energized",onTap:function(t){e.product.supplier=angular.copy(e.supplier),e.supplier=angular.copy(f)}}]}).then(function(e){})},e.save=function(){g(function(e){r.goBack()}.bind(this))},e.saveAndNew=function(){g(function(i){e.product=angular.copy(h),e.supplier=angular.copy(f),t.reload()}.bind(this))}}])}(),function(){"use strict";angular.module("product.controllers",["prodcut-add.controllers"]).controller("ProductCtrl",["$scope","$state","$ionicPopup","ProductService","$ionicHistory","$ionicLoading","$timeout",function(e,t,i,o,n,a,r){e.$on("$ionicView.beforeEnter",function(t,i){e.isReady=!1,e.show(),e.page=0,e.size=10,e.products=[],e.doRefresh(),e.isReady=!0,r(function(){a.hide(),e.loadingMore=!0},1e3),e.model.name=""}),e.doRefresh=function(){e.page=0,e.search(!0),r(function(){e.$broadcast("scroll.refreshComplete")},1e3)},e.model={},e.getByName=function(){e.page=0,e.search(!0)},e.loadMore=function(){e.loadingMore=!1,e.page++,e.search(),r(function(){e.loadingMore=!0,e.$broadcast("scroll.infiniteScrollComplete")},1e3)},e.search=function(t){var i=o.query(e.page,e.size,e.model.name);console.log(i.items.length),e.products=t?i.items:(e.products||[]).concat(i.items),e.total=i.total},e.show=function(){a.show({template:"<ion-spinner></ion-spinner>"})},e.hide=function(){a.hide()},e.moreDataCanBeLoaded=function(){return e.loadingMore&&e.products.length<e.total}}])}(),function(){"use strict";angular.module("product.service",[]).factory("ProductService",["LocalStorageService",function(e){var t={},i="PRODUCT",o=[{id:1,images:[],name:"iphone7",price:"5388",stock:12,barcode:"12121212112"},{id:2,images:[],name:"node7",price:"5388",stock:120,barcode:"12121212112"},{id:3,images:[],name:"小米5 plus",price:"1999",stock:12,barcode:"12121212112"},{id:4,images:[],name:"iPhone7 plus",price:"6388",stock:12,barcode:"12121212112"},{id:5,images:[],name:"华为 P9",price:"3388",stock:19,barcode:"12121212112"},{id:6,images:[],name:"小米5",price:"1599",stock:9,barcode:"12121212112"},{id:7,images:[],name:"iphone7p",price:"5388",stock:12,barcode:"12121212112"},{id:8,images:[],name:"node71",price:"5388",stock:120,barcode:"12121212112"},{id:9,images:[],name:"小米5z plus",price:"1999",stock:12,barcode:"12121212112"},{id:10,images:[],name:"iPhone7a plus",price:"6388",stock:12,barcode:"12121212112"},{id:11,images:[],name:"华为 P93",price:"3388",stock:19,barcode:"12121212112"},{id:12,images:[],name:"小米52",price:"1599",stock:9,barcode:"12121212112"},{id:13,images:[],name:"iphone7",price:"5388",stock:12,barcode:"12121212112"},{id:14,images:[],name:"node7",price:"5388",stock:120,barcode:"12121212112"},{id:15,images:[],name:"小米5 plus",price:"1999",stock:12,barcode:"12121212112"},{id:16,images:[],name:"iPhone7 plus",price:"6388",stock:12,barcode:"12121212112"},{id:17,images:[],name:"华为 P9",price:"3388",stock:19,barcode:"12121212112"},{id:18,images:[],name:"小米5",price:"1599",stock:9,barcode:"12121212112"},{id:19,images:[],name:"iphone7p",price:"5388",stock:12,barcode:"12121212112"},{id:20,images:[],name:"node71",price:"5388",stock:120,barcode:"12121212112"},{id:21,images:[],name:"小米5z plus",price:"1999",stock:12,barcode:"12121212112"},{id:22,images:[],name:"iPhone7a plus",price:"6388",stock:12,barcode:"12121212112"},{id:23,images:[],name:"华为 P93",price:"3388",stock:19,barcode:"12121212112"},{id:24,images:[],name:"小米52",price:"1599",stock:9,barcode:"12121212112"}];return t.init=function(){this.originData=e.get(i),this.originData||(e.update(i,o),this.originData=o),this.originData=this.originData.sort(function(e,t){return t.id-e.id}),this.refresh()},t.refresh=function(){e.update(i,this.originData),this.dataMap={},this.originData.forEach(function(e){this.dataMap[e.id]=e}.bind(this)),this.nowId=this.originData.length?Math.max.apply(null,this.originData.map(function(e){return e.id})):0},t.getAll=function(){return angular.copy(this.originData)},t.getProductById=function(e){return angular.copy(this.dataMap[e])},t.query=function(e,t,i){var o=i?this.originData.filter(function(e){return~e.name.indexOf(i)}):angular.copy(this.originData);return{items:angular.copy(o).splice(e*t,t),total:o.length}},t.createProduct=function(e){return e.id=this.nowId+1,this.originData.push(angular.copy(e)),this.refresh(),e.id},t.deleteProduct=function(e){return this.originData=this.originData.filter(function(t){return t.id!=e}),this.refresh(),!0},t.updateProduct=function(e,t){return this.originData.forEach(function(i){i.id==e&&(i.name=t.name)}),this.refresh(),this.getProductById(e)},t.init(),t}])}(),function(){"use strict";angular.module("setting.controllers",[]).controller("SettingCtrl",["$scope","$state","$ionicPopup","UserService","$ionicHistory",function(e,t,i,o,n){e.goBack=function(){n.nextViewOptions({disableBack:!0}),t.go("app.home")},e.exitApp=function(){o.updateIsLogin(!1),n.nextViewOptions({historyRoot:!0}),t.go("login",{},{location:"replace"})}}])}(),function(){"use strict";angular.module("shop-edit.controllers",[]).controller("ShopEditCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory","$stateParams",function(e,t,i,o,n,a){var r={title:"黄加樑的店",alias:"小店",registerTime:"2017-04-01 08:00:00",phone:"18305961659",email:"hjl4347570@163.com",shopOwner:"黄加樑",shopPhone:"18305961659",industryClassification:"软件服务行业"};e.shop=o.get("SHOP",r),e.title=a.title,e.model={inputValue:e.shop[a.key]},e.save=function(){e.shop[a.key]=e.model.inputValue,o.update("SHOP",e.shop),n.goBack()}}])}(),function(){"use strict";angular.module("shop.controllers",["shop-edit.controllers"]).controller("ShopCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(e,t,i,o,n){var a={title:"黄加樑的店",alias:"小店",registerTime:"2017-04-01 08:00:00",phone:"18305961659",email:"hjl4347570@163.com",shopOwner:"黄加樑",shopPhone:"18305961659",industryClassification:"软件服务行业"};e.$on("$stateChangeSuccess",function(){e.shop=o.get("SHOP",a)})}])}(),function(){"use strict";angular.module("welcome.controllers",[]).controller("WelcomeCtrl",["$scope",function(e){}])}(),function(){"use strict"}(),function(){"use strict"}(),function(){"use strict";angular.module("password.controllers",[]).controller("PasswordCtrl",["$scope","$state","$ionicPopup","UserService","$ionicHistory",function(e,t,i,o,n){var a=null;e.$on("$ionicView.beforeEnter",function(e,t){a=o.getUserData()}),e.model={op:"",p:"",cp:""},e.save=function(r){r&&(e.model.op===a.password?e.model.p&&e.model.p===e.model.cp?(a.password=e.model.p,o.updateUserData(a),n.nextViewOptions({historyRoot:!0}),t.go("login",{},{})):i.alert({title:"警告",template:"您两次输入的密码不一致",okText:"确定",okType:"button-energized"}):i.alert({title:"警告",template:"您输入的密码错误",okText:"确定",okType:"button-energized"}))}}])}(),function(){"use strict";angular.module("user.controllers",["password.controllers"]).controller("UserCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(e,t,i,o,n){}])}(),function(){"use strict";angular.module("user.service",[]).factory("UserService",["LocalStorageService",function(e){var t={},i={username:"admin",password:"123456"},o={value:!1};return t.init=function(){this.userData=e.get("USER_DATA"),this.isLogin=e.get("IS_LOGIN"),this.userData||(e.add("USER_DATA",i),this.userData=i),this.isLogin||(e.add("IS_LOGIN",o),this.isLogin=o)},t.getUserData=function(){return this.userData},t.updateUserData=function(t){return e.update("USER_DATA",t),this.updateIsLogin(!1),this.userData=t,!0},t.getRememberUser=function(){return e.get("USER_INFO",{username:"",password:""})},t.updateRememberUser=function(t){return e.update("USER_INFO",t),!0},t.getIsLogin=function(){return this.isLogin.value},t.updateIsLogin=function(t){return e.update("IS_LOGIN",{value:t}),this.isLogin.value=t,!0},t.init(),t}])}();