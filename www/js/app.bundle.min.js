!function(){"use strict";angular.module("home.controllers",[]).controller("HomeCtrl",["$scope","$state","UserService",function(t,e,i){t.$on("$ionicView.beforeEnter",function(t,o){i.getIsLogin()||e.go("login")})}])}(),function(){"use strict"}(),function(){"use strict"}(),function(){"use strict";angular.module("about.controllers",[]).controller("AboutCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(t,e,i,o,n){}])}(),function(){"use strict";angular.module("login.controllers",[]).controller("LoginCtrl",["$scope","$state","$ionicPopup","UserService",function(t,e,i,o){var n=o.getUserData();t.loginData=o.getRememberUser(),t.login=function(){t.loginData.username==n.username&&t.loginData.password==n.password?(o.updateRememberUser(t.loginData),o.updateIsLogin(!0),e.go("app.home",{},{location:"replace"})):i.alert({title:"警告",template:"您的用户名或者密码错误",okText:"确定",okType:"button-energized"})}}])}(),function(){"use strict";angular.module("prodcut-add.controllers",[]).controller("ProductAddCtrl",["$scope","$state","$ionicPopup","$ionicActionSheet","ProductService","CategoryService","$ionicHistory","$stateParams","$cordovaBarcodeScanner","$cordovaCamera","$cordovaImagePicker",function(t,e,i,o,n,a,r,c,s,u,d){function l(){var e={quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,targetWidth:100,targetHeight:100,correctOrientation:!0,saveToPhotoAlbum:!1,popoverOptions:CameraPopoverOptions};u.getPicture(e).then(function(e){t.product.images.push(e)},function(t){alert(t)})}function p(){var e={maximumImagesCount:3,width:0,height:0,quality:80};d.getPictures(e).then(function(e){for(var i=0;i<e.length;i++)t.product.images.push(e[i])},function(t){alert(t)})}function g(e){i.confirm({title:"您确认要新增商品吗？",cancelText:"取消",okText:"确认"}).then(function(){n.createProduct(t.product),e()})}var h={images:[],barcode:"",category:{id:0,name:"默认分类",section:{id:0,name:""}},name:"",price:"",cost:"",stock:"",size:"",remark:"",supplier:{name:"",phone:""}},f={name:"",phone:""};t.product=angular.copy(h),t.supplier=angular.copy(f),t.$on("ActiveCategoryUpdate",function(){t.product.category=a.activeCategory}),t.scanBarcode=function(){s.scan().then(function(e){t.product.barcode=e.text,alert(e.text)},function(t){alert(t)})},t.showActionSheet=function(){o.show({buttons:[{text:"拍照"},{text:"从相册中选取"}],cancelText:"<b>取消</b>",buttonClicked:function(t){switch(t){case 0:l();break;case 1:p()}}})},t.selectSupplier=function(){i.show({title:"新增供应商",templateUrl:"views/supplier/supplier.html",scope:t,buttons:[{text:"取消",type:"button-energized button-outline",onTap:function(e){t.supplier=angular.copy(f)}},{text:"确定",type:"button-energized",onTap:function(e){t.product.supplier=angular.copy(t.supplier),t.supplier=angular.copy(f)}}]}).then(function(t){})},t.save=function(){g(function(t){r.goBack()}.bind(this))},t.saveAndNew=function(){g(function(i){t.product=angular.copy(h),t.supplier=angular.copy(f),e.reload()}.bind(this))}}])}(),function(){"use strict";angular.module("product.controllers",["prodcut-add.controllers"]).controller("ProductCtrl",["$scope","$state","$ionicPopup","ProductService","$ionicHistory","$ionicLoading","$timeout",function(t,e,i,o,n,a,r){t.$on("$ionicView.beforeEnter",function(e,i){t.isReady=!1,t.show(),t.products=o.getAll(),r(function(){a.hide(),t.isReady=!0},1e3)}),t.getByName=function(){},t.show=function(){a.show({template:"<ion-spinner></ion-spinner>"})},t.hide=function(){a.hide()}}])}(),function(){"use strict";angular.module("product.service",[]).factory("ProductService",["LocalStorageService",function(t){var e={},i="PRODUCT",o=[{id:1,images:[],name:"iphone7",price:"5388",stock:12,barcode:"12121212112"},{id:2,images:[],name:"node7",price:"5388",stock:120,barcode:"12121212112"},{id:3,images:[],name:"小米5 plus",price:"1999",stock:12,barcode:"12121212112"},{id:4,images:[],name:"iPhone7 plus",price:"6388",stock:12,barcode:"12121212112"},{id:5,images:[],name:"华为 P9",price:"3388",stock:19,barcode:"12121212112"},{id:6,images:[],name:"小米5",price:"1599",stock:9,barcode:"12121212112"}];return e.init=function(){this.originData=t.get(i),this.originData||(t.update(i,o),this.originData=o),this.refresh()},e.refresh=function(){t.update(i,this.originData),this.dataMap={},this.originData.forEach(function(t){this.dataMap[t.id]=t}.bind(this)),this.nowId=this.originData.length?Math.max.apply(null,this.originData.map(function(t){return t.id})):0},e.getAll=function(){return angular.copy(this.originData)},e.getProductById=function(t){return angular.copy(this.dataMap[t])},e.createProduct=function(t){return t.id=this.nowId+1,this.originData.push(angular.copy(t)),this.refresh(),t.id},e.deleteProduct=function(t){return this.originData=this.originData.filter(function(e){return e.id!=t}),this.refresh(),!0},e.updateProduct=function(t,e){return this.originData.forEach(function(i){i.id==t&&(i.name=e.name)}),this.refresh(),this.getProductById(t)},e.init(),e}])}(),function(){"use strict";angular.module("menu.controllers",[]).controller("AppCtrl",["$scope","$ionicModal","$timeout",function(t,e,i){t.loginData={},t.shopData={name:"黄加樑",phone:"18305961659"}}])}(),function(){"use strict";angular.module("setting.controllers",[]).controller("SettingCtrl",["$scope","$state","$ionicPopup","UserService","$ionicHistory",function(t,e,i,o,n){t.goBack=function(){n.nextViewOptions({disableBack:!0}),e.go("app.home")},t.exitApp=function(){o.updateIsLogin(!1),n.nextViewOptions({historyRoot:!0}),e.go("login",{},{location:"replace"})}}])}(),function(){"use strict";angular.module("password.controllers",[]).controller("PasswordCtrl",["$scope","$state","$ionicPopup","UserService","$ionicHistory",function(t,e,i,o,n){var a=null;t.$on("$ionicView.beforeEnter",function(t,e){a=o.getUserData()}),t.model={op:"",p:"",cp:""},t.save=function(){t.model.op===a.password?t.model.p&&t.model.p===t.model.cp?(a.password=t.model.p,o.updateUserData(a),n.nextViewOptions({historyRoot:!0}),e.go("login",{},{})):i.alert({title:"警告",template:"您两次输入的密码不一致",okText:"确定",okType:"button-energized"}):i.alert({title:"警告",template:"您输入的密码错误",okText:"确定",okType:"button-energized"})}}])}(),function(){"use strict";angular.module("user.controllers",["password.controllers"]).controller("UserCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(t,e,i,o,n){}])}(),function(){"use strict";angular.module("user.service",[]).factory("UserService",["LocalStorageService",function(t){var e={},i={username:"admin",password:"123456"},o={value:!1};return e.init=function(){this.userData=t.get("USER_DATA"),this.isLogin=t.get("IS_LOGIN"),this.userData||(t.add("USER_DATA",i),this.userData=i),this.isLogin||(t.add("IS_LOGIN",o),this.isLogin=o)},e.getUserData=function(){return this.userData},e.updateUserData=function(e){return t.update("USER_DATA",e),this.updateIsLogin(!1),this.userData=e,!0},e.getRememberUser=function(){return t.get("USER_INFO",{username:"",password:""})},e.updateRememberUser=function(e){return t.update("USER_INFO",e),!0},e.getIsLogin=function(){return this.isLogin.value},e.updateIsLogin=function(e){return t.update("IS_LOGIN",{value:e}),this.isLogin.value=e,!0},e.init(),e}])}(),function(){"use strict";angular.module("welcome.controllers",[]).controller("WelcomeCtrl",["$scope",function(t){}])}(),function(){"use strict"}(),function(){"use strict"}(),function(){"use strict";angular.module("category-add.controllers",[]).controller("categoryAddCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicActionSheet","$stateParams",function(t,e,i,o,n,a){t.$on("$ionicView.beforeEnter",function(){t.addCategory="0"==a.id,t.category=i.getCategoryById(a.id)||{name:""},t.sections=[{name:""}]}),t.addSection=function(){t.sections.filter(function(t){return!t.name}).length||t.sections.push({name:""})},t.removeSection=function(e){t.sections.splice(e,1)},t.saveCategory=function(){var o=t.sections.filter(function(t){return!t.name});if(!t.category.id&&t.category.name||t.category.id&&!o.length)if(t.category.id)i.createSubCategory(t.category.id,angular.copy(t.sections)),e.go("app.category",{activeId:t.category.id},{location:"replace"});else{t.category.children=t.sections;var n=i.addCategory(angular.copy(t.category));e.go("app.category",{activeId:n},{location:"replace"})}}}])}(),function(){"use strict";angular.module("category-edit.controllers",[]).controller("categoryEditCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicPopup","$stateParams",function(t,e,i,o,n,a){t.category=i.getCategoryById(a.id),t.sections=t.category.children||[],t.addSection=function(){t.sections.filter(function(t){return!t.name}).length||t.sections.push({name:""})},t.removeCategory=function(){n.confirm({title:"您确认要删除吗？",template:"请先删除该类别下的所有商品记录",cancelText:"取消",okText:"确认"}).then(function(o){i.deleteCategory(t.category.id),e.go("app.category",{activeId:t.category.id},{location:"replace"})})},t.removeSection=function(e){n.confirm({title:"您确认要删除吗？",template:"请先删除该类别下的所有商品记录",cancelText:"取消",okText:"确认"}).then(function(i){t.sections.splice(e,1)})},t.saveCategory=function(){var o=t.sections.filter(function(t){return!t.name});t.category.name&&!o.length&&(t.category.children=t.sections,i.updateCategory(t.category.id,t.category),e.go("app.category",{activeId:t.category.id},{location:"replace"}))}}])}(),function(){"use strict";angular.module("category.controllers",["category-add.controllers","category-edit.controllers"]).controller("categoryCtrl",["$scope","$state","CategoryService","$ionicHistory","$ionicActionSheet","$stateParams",function(t,e,i,o,n,a){var r=a.activeId||0;t.$on("$stateChangeSuccess",function(e,o,n,a,c){if("app.home"===a.name&&(t.showInfo="无小分类进入大分类"),"app.product"===a.name&&(t.showInfo="全部商品"),"app.category"!==a.name)if(t.categories=i.getAll(!0),r){var s=!1;t.categories.forEach(function(e){e.id==r&&(t.activeCategory=e,t.sections=e.children,s=!0,t.sections&&0!=t.sections[0].id&&t.sections.unshift({id:0,name:t.showInfo||"无小分类进入大分类"}))}),s||(t.activeCategory=t.categories[0],t.sections=t.categories[0].children,t.sections&&0!=t.sections[0].id&&t.sections.unshift({id:0,name:t.showInfo||"无小分类进入大分类"}))}else t.activeCategory=t.categories[0],t.sections=t.categories[0].children,t.sections&&0!=t.sections[0].id&&t.sections.unshift({id:0,name:t.showInfo||"无小分类进入大分类"})}),t.selectCategory=function(e){t.activeCategory.id!=e&&angular.forEach(t.categories,function(i,o){i.id==e&&(t.activeCategory=i,t.sections=i.children,t.sections&&0!=t.sections[0].id&&t.sections.unshift({id:0,name:t.showInfo||"无小分类进入大分类"}))})},t.selectSection=function(e){t.activeSection={id:t.activeCategory.id,name:t.activeCategory.name,section:{id:e.id,name:e.id?e.name:""}},o.goBack()},t.$watch("activeSection",function(t,e){t&&i.updateActiveCategory(t)}),t.showActionSheet=function(){n.show({buttons:[{text:"新增小分类"},{text:"编辑分类"}],cancelText:"<b>取消</b>",buttonClicked:function(i){switch(i){case 0:e.go("app.categoryAdd",{id:t.activeCategory.id});break;case 1:e.go("app.categoryEdit",{id:t.activeCategory.id})}}})}}])}(),function(){"use strict";angular.module("category.service",[]).factory("CategoryService",["$rootScope","LocalStorageService",function(t,e){var i={},o="CATEGORY",n=[{id:1,name:"电脑整机",parent_id:0},{id:2,name:"电脑配件",parent_id:0},{id:3,name:"外设产品",parent_id:0},{id:4,name:"网络产品",parent_id:0},{id:5,name:"笔记本",parent_id:1},{id:6,name:"台式机",parent_id:1},{id:7,name:"平板电脑",parent_id:1},{id:8,name:"CPU",parent_id:2},{id:9,name:"内存",parent_id:2},{id:10,name:"鼠标",parent_id:3},{id:11,name:"键盘",parent_id:3},{id:12,name:"U盘",parent_id:3},{id:13,name:"路由器",parent_id:4},{id:14,name:"交换机",parent_id:4},{id:15,name:"网卡",parent_id:4},{id:16,name:"网络配件",parent_id:4}];return i.activeCategory={},i.updateActiveCategory=function(e){this.activeCategory=angular.copy(e),t.$broadcast("ActiveCategoryUpdate")},i.init=function(){this.originData=e.get(o),this.originData||(e.update(o,n),this.originData=n),this.refresh()},i.refresh=function(){this.dataMap={},this.originData.forEach(function(t){if(!t.parent_id){var e=angular.copy(t);e.children=[],this.dataMap[e.id]=e}}.bind(this)),this.originData.forEach(function(t){if(t.parent_id){var e=angular.copy(t);this.dataMap[t.parent_id].children.push(e)}}.bind(this)),this.nowId=this.originData.length?Math.max.apply(null,this.originData.map(function(t){return t.id})):0},i.getAll=function(t){return t?Object.keys(this.dataMap).map(function(t){return angular.copy(this.dataMap[t])}.bind(this)):this.originData},i.getCategoryById=function(t){return angular.copy(this.dataMap[t])},i.getSubCategoryByCategoryId=function(t){return this.dataMap[id]&&angular.copy(this.dataMap[id].children)},i.addCategory=function(t){var e=t.children||[];delete t.children;var i=this.createCategory(t);return e.length&&this.createSubCategory(i,e),i},i.createCategory=function(t){return t.id=this.nowId+1,t.parent_id=0,this.originData.push(t),e.update(o,this.originData),this.refresh(),t.id},i.createSubCategory=function(t,i){return i=i.map(function(e,i){return e.id=this.nowId+i+1,e.parent_id=t,e}.bind(this)),this.originData=this.originData.concat(i),e.update(o,this.originData),this.refresh(),!0},i.deleteCategory=function(t){return this.originData=this.originData.filter(function(e){return e.parent_id!=t&&e.id!=t}),e.update(o,this.originData),this.refresh(),!0},i.deleteSubCategoryByCategoryId=function(t){return this.originData=this.originData.filter(function(e){return e.parent_id!=t}),e.update(o,this.originData),this.refresh(),!0},i.updateCategory=function(t,e){return this.originData.forEach(function(i){i.id==t&&(i.name=e.name)}),e.children.length&&this.updateSubCategory(t,e.children),this.refresh(),this.getCategoryById(t)},i.updateSubCategory=function(t,e){return this.deleteSubCategoryByCategoryId(t),this.createSubCategory(t,e),!0},i.init(),i}])}(),function(){"use strict";angular.module("shop-edit.controllers",[]).controller("ShopEditCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory","$stateParams",function(t,e,i,o,n,a){var r={title:"黄加樑的店",alias:"小店",registerTime:"2017-04-01 08:00:00",phone:"18305961659",email:"hjl4347570@163.com",shopOwner:"黄加樑",shopPhone:"18305961659",industryClassification:"软件服务行业"};t.shop=o.get("SHOP",r),t.title=a.title,t.model={inputValue:t.shop[a.key]},t.save=function(){t.shop[a.key]=t.model.inputValue,o.update("SHOP",t.shop),n.goBack()}}])}(),function(){"use strict";angular.module("shop.controllers",["shop-edit.controllers"]).controller("ShopCtrl",["$scope","$state","$ionicPopup","LocalStorageService","$ionicHistory",function(t,e,i,o,n){var a={title:"黄加樑的店",alias:"小店",registerTime:"2017-04-01 08:00:00",phone:"18305961659",email:"hjl4347570@163.com",shopOwner:"黄加樑",shopPhone:"18305961659",industryClassification:"软件服务行业"};t.$on("$stateChangeSuccess",function(){t.shop=o.get("SHOP",a)})}])}();